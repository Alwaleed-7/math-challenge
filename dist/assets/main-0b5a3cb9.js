(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const P of i.addedNodes)P.tagName==="LINK"&&P.rel==="modulepreload"&&o(P)}).observe(document,{childList:!0,subtree:!0});function r(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(n){if(n.ep)return;n.ep=!0;const i=r(n);fetch(n.href,i)}})();let s=0,p=0,a=60,B=null,h="easy",l=1,v=JSON.parse(localStorage.getItem("highScores"))||{easy:0,medium:0,hard:0},$=0,g=JSON.parse(localStorage.getItem("achievements"))||{},U=[],C=localStorage.getItem("soundEnabled")!=="false";const j={first_correct:{id:"first_correct",name:"First Steps",description:"Answer your first question correctly",icon:"fa-check",condition:()=>!0,secret:!1,repeatable:!1},speed_demon:{id:"speed_demon",name:"Speed Master",description:"Answer 10 questions correctly in under 20 seconds",icon:"fa-bolt",condition:()=>!1,secret:!1,repeatable:!0},perfect_20:{id:"perfect_20",name:"Perfect Streak",description:"Get a streak of 20 correct answers",icon:"fa-fire",condition:()=>p>=20,secret:!1,repeatable:!0},math_wizard:{id:"math_wizard",name:"Math Wizard",description:"Reach level 10",icon:"fa-hat-wizard",condition:()=>l>=10,secret:!1,repeatable:!1},high_scorer:{id:"high_scorer",name:"High Scorer",description:"Score over 1000 points",icon:"fa-trophy",condition:()=>s>=1e3,secret:!1,repeatable:!0},power_user:{id:"power_user",name:"Power User",description:"Use all power-ups effectively in one game",icon:"fa-bolt",condition:()=>!1,secret:!0,repeatable:!0}};let A={},u=null,N={};const ne={correct:"sounds/correct.mp3",wrong:"sounds/wrong.mp3",levelUp:"sounds/level-up.mp3",gameOver:"sounds/game-over.mp3",powerUp:"sounds/power-up.mp3",achievement:"sounds/achievement.mp3"};async function re(){try{u=new(window.AudioContext||window.webkitAudioContext);for(const[e,t]of Object.entries(ne))try{const o=await(await fetch(t)).arrayBuffer(),n=await u.decodeAudioData(o);N[e]=n}catch(r){console.log(`Error loading sound ${e}:`,r)}}catch(e){console.log("Audio context initialization error:",e)}}function k(e){if(!(!C||!u||!N[e]))try{u.state==="suspended"&&u.resume();const t=u.createBufferSource();t.buffer=N[e],t.connect(u.destination),t.start(0)}catch(t){console.log("Sound play error:",t)}}document.addEventListener("click",function e(){u||(re(),document.removeEventListener("click",e))},{once:!1});const R=document.getElementById("game-menu"),D=document.getElementById("game-area"),z=document.getElementById("game-over"),d=document.getElementById("problem"),T=document.getElementById("answer"),ie=document.getElementById("submit"),se=document.getElementById("score"),K=document.getElementById("timer"),le=document.getElementById("level"),ae=document.getElementById("streak"),ce=document.getElementById("streak-progress"),me=document.getElementById("final-score"),q=document.getElementById("high-score"),ue=document.getElementById("play-again"),pe=document.getElementById("settings-icon"),W=document.getElementById("settings-panel"),de=document.getElementById("close-settings"),O=document.getElementById("sound-toggle"),fe=document.getElementById("reset-progress"),M=document.getElementById("achievements-list"),c={"time-boost":document.getElementById("time-boost"),"point-multiplier":document.getElementById("point-multiplier"),"skip-problem":document.getElementById("skip-problem")};function he(){powerUpCounts={"time-boost":3,"point-multiplier":2,"skip-problem":3},powerUpCooldownTimers={"time-boost":0,"point-multiplier":0,"skip-problem":0},A={},Object.keys(c).forEach(e=>{c[e].title=`${e.split("-").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" ")}`,c[e].disabled=!1,c[e].addEventListener("click",()=>X(e))})}he();const G={easy:{maxNumber:12,operations:["+","-","×"],timeBonus:3,scoreMultiplier:1,initialTime:90},medium:{maxNumber:15,operations:["+","-","×","÷"],timeBonus:2,scoreMultiplier:2,initialTime:60},hard:{maxNumber:20,operations:["+","-","×","÷","^"],timeBonus:1,scoreMultiplier:3,initialTime:45}};document.getElementById("easy").addEventListener("click",()=>H("easy"));document.getElementById("medium").addEventListener("click",()=>H("medium"));document.getElementById("hard").addEventListener("click",()=>H("hard"));function J(e){const t=1+Math.floor((l-1)/3)*.5,r=Math.min(t,2.5),o=Math.max(1,Math.floor(e*(r-1)*.5));return Math.floor(Math.random()*(e*r-o+1))+o}function ge(){const e=G[h];let t;l<=2?t=["+"]:l<=5?t=["+","-"]:l<=7?t=["×"]:l<=10?t=["+","-","×","÷"]:t=["+","-","×","÷","^"];const r=t[Math.floor(Math.random()*t.length)];let o=J(e.maxNumber),n=J(e.maxNumber),i;if(r==="÷")i=o,o=o*n;else switch(r){case"+":i=o+n;break;case"-":i=o-n;break;case"×":i=o*n;break;case"^":n=Math.min(3,n),i=Math.pow(o,n);break}return{problem:`${o} ${r} ${n} = ?`,answer:i}}function H(e){h=e,s=0,p=0,l=1,a=G[e].initialTime,$=v[h],window.powerUpSystem&&window.powerUpSystem.initializePowerUps(),U=[],x(),R.style.display="none",D.style.display="block",z.style.display="none",F(),ye(),window.tutorialSystem&&window.tutorialSystem.init()}function x(){se.textContent=s,K.textContent=a,le.textContent=l,ae.textContent=p,ce.style.width=`${p/5*100}%`,q.textContent=$}function ye(){B&&clearInterval(B),B=setInterval(()=>{a--,K.textContent=a,a<=0&&V()},1e3)}function F(){const{problem:e,answer:t}=ge();d.textContent=e,d.dataset.answer=t,T.value="",setTimeout(()=>{T.focus()},10)}function Q(){const e=parseInt(T.value),t=parseInt(d.dataset.answer),r=G[h];if(e===t){k("correct"),p++;const o=Math.floor(p/5);let i=(10+Math.floor(l/2))*r.scoreMultiplier*(1+o);activePowerUp==="point-multiplier"&&(i*=2),s+=i,a+=r.timeBonus,s>l*100&&(l++,k("levelUp")),d.style.color="#48bb78",setTimeout(()=>d.style.color="#2d3748",300),we("correct"),p>=5&&a>=45&&L("speed_demon")}else{k("wrong"),p=0,a-=5;const o=5*r.scoreMultiplier,n=Math.floor(l/2)*r.scoreMultiplier,i=Math.min(s,o+n);if(s=Math.max(0,s-i),d.style.color="#e53e3e",setTimeout(()=>d.style.color="#2d3748",300),a<=0){V();return}}x(),F()}function V(){clearInterval(B),s>v[h]&&(v[h]=s,$=s,localStorage.setItem("highScores",JSON.stringify(v))),D.style.display="none",z.style.display="block",me.textContent=s,q.textContent=v[h],be()}ie.addEventListener("click",Q);T.addEventListener("keypress",e=>{e.key==="Enter"&&Q()});ue.addEventListener("click",()=>{z.style.display="none",R.style.display="block"});pe.addEventListener("click",()=>{W.classList.add("active")});de.addEventListener("click",()=>{W.classList.remove("active")});O.addEventListener("change",()=>{C=O.checked,localStorage.setItem("soundEnabled",C)});fe.addEventListener("click",()=>{confirm("Are you sure you want to reset all progress? This will clear your high scores and achievements.")&&(localStorage.removeItem("highScores"),localStorage.removeItem("achievements"),v={easy:0,medium:0,hard:0},$=0,g={},q.textContent="0",alert("Progress has been reset!"))});O.checked=C;function we(e){e==="correct"&&!g.first_correct&&L("first_correct"),Object.values(j).forEach(t=>{!g[t.id]&&t.condition()&&L(t.id)})}function L(e){if(g[e])return;const t=j[e];g[e]=!0,localStorage.setItem("achievements",JSON.stringify(g)),U.includes(e)||U.push(e),k("achievement");const r=50;s+=r,x();const o=document.createElement("div");o.className="achievement-notification",o.innerHTML=`
        <i class="fas ${t.icon}"></i>
        <div>
            <h4>${t.name}</h4>
            <p>${t.description}</p>
            <span class="achievement-bonus">+${r} points!</span>
        </div>
    `,document.body.appendChild(o),setTimeout(()=>{o.classList.add("fade-out"),setTimeout(()=>o.remove(),500)},3e3)}function be(){if(M.innerHTML="",U.length===0){const e=document.createElement("div");e.className="no-achievements",e.textContent="No achievements earned this game.",M.appendChild(e);return}U.forEach(e=>{const t=j[e];if(t){const r=document.createElement("div");r.className="achievement-badge unlocked",r.innerHTML=`
                <i class="fas ${t.icon}"></i>
                <span>${t.name}</span>
            `,r.title=t.description,M.appendChild(r)}})}Object.keys(c).forEach(e=>{c[e].addEventListener("click",()=>X(e))});function X(e){if(powerUpCooldownTimers[e]>0||powerUpCounts[e]<=0)return;switch(powerUpCounts[e]--,updatePowerUpCounts(),A[e]=!0,Object.keys(A).length===Object.keys(c).length&&!g.power_user&&L("power_user"),k("powerUp"),e){case"time-boost":a+=15;break;case"point-multiplier":activePowerUp=e,powerUpTimeLeft=15,powerUpTimer&&clearInterval(powerUpTimer),powerUpTimer=setInterval(()=>{powerUpTimeLeft--,powerUpTimeLeft<=0&&(clearInterval(powerUpTimer),activePowerUp=null)},1e3);break;case"skip-problem":F();break}powerUpCooldownTimers[e]=powerUpCooldowns[e],c[e].classList.add("cooldown");const t=setInterval(()=>{powerUpCooldownTimers[e]--,powerUpCooldownTimers[e]<=0&&(clearInterval(t),c[e].classList.remove("cooldown"))},1e3);x()}let E=null,I=0,y=null;const ve={"time-boost":30,"point-multiplier":45,"skip-problem":20};let b={"time-boost":0,"point-multiplier":0,"skip-problem":0},S={"time-boost":3,"point-multiplier":2,"skip-problem":3},_={};function Y(e){switch(e){case"time-boost":return"clock";case"point-multiplier":return"star";case"skip-problem":return"forward";default:return""}}function Ee(){S={"time-boost":3,"point-multiplier":2,"skip-problem":3},b={"time-boost":0,"point-multiplier":0,"skip-problem":0},_={},E=null,I=0,y&&clearInterval(y),Object.keys(powerUpButtons).forEach(e=>{const t=powerUpButtons[e];t.title=`${e.split("-").map(r=>r.charAt(0).toUpperCase()+r.slice(1)).join(" ")}`,t.disabled=!1,t.innerHTML=`<i class="fas fa-${Y(e)}"></i> (${S[e]})`,t.addEventListener("click",()=>Z(e))})}function Z(e){if(S[e]<=0||b[e]>0)return;const t=powerUpButtons[e];S[e]--,t.innerHTML=`<i class="fas fa-${Y(e)}"></i> (${S[e]})`,playSound("powerUp"),b[e]=ve[e],t.disabled=!0;const r=setInterval(()=>{b[e]--,t.title=`Cooldown: ${b[e]}s`,b[e]<=0&&(clearInterval(r),t.disabled=!1,t.title=e.split("-").map(o=>o.charAt(0).toUpperCase()+o.slice(1)).join(" "))},1e3);switch(e){case"time-boost":timeLeft+=15,timerElement.textContent=timeLeft;break;case"point-multiplier":E==="point-multiplier"&&clearTimeout(y),E="point-multiplier",I=15,y=setInterval(()=>{I--,I<=0&&(clearInterval(y),E=null)},1e3);break;case"skip-problem":updateProblem();break}_[e]=!0,Object.keys(_).length===3&&unlockAchievement("power_user")}window.powerUpSystem={initializePowerUps:Ee,usePowerUp:Z,getActivePowerUp:()=>E,resetPowerUps:()=>{y&&clearInterval(y),E=null,I=0}};let ee=localStorage.getItem("tutorialShown")!=="true",m,f=0,w=[{target:"time-boost",title:"Time Boost",description:"Adds 15 seconds to your timer. Use this when you need more time!",position:"bottom"},{target:"point-multiplier",title:"Point Multiplier",description:"Doubles all points earned for 15 seconds. Great for boosting your score!",position:"bottom"},{target:"skip-problem",title:"Skip Problem",description:"Skip the current problem without penalty. Perfect for difficult questions!",position:"bottom"}];function ke(){m=document.createElement("div"),m.className="tutorial-overlay",document.body.appendChild(m);const e=document.createElement("div");e.className="tutorial-content",m.appendChild(e);const t=document.createElement("h3");t.className="tutorial-title",e.appendChild(t);const r=document.createElement("p");r.className="tutorial-description",e.appendChild(r);const o=document.createElement("div");o.className="tutorial-nav",e.appendChild(o);const n=document.createElement("button");n.className="tutorial-btn",n.textContent="Next",n.addEventListener("click",Ie),o.appendChild(n);const i=document.createElement("button");i.className="tutorial-btn tutorial-skip",i.textContent="Skip Tutorial",i.addEventListener("click",Se),o.appendChild(i)}function te(e){const t=w[e],r=document.getElementById(t.target),o=r.getBoundingClientRect(),n=m.querySelector(".tutorial-content");m.querySelector(".tutorial-title").textContent=t.title,m.querySelector(".tutorial-description").textContent=t.description,t.position==="bottom"?(n.style.top=`${o.bottom+10}px`,n.style.left=`${o.left+o.width/2-150}px`):t.position==="top"&&(n.style.top=`${o.top-n.offsetHeight-10}px`,n.style.left=`${o.left+o.width/2-150}px`),r.classList.add("tutorial-highlight"),e===w.length-1&&(m.querySelector(".tutorial-btn").textContent="Got it!")}function Ie(){f<w.length&&document.getElementById(w[f].target).classList.remove("tutorial-highlight"),f++,f<w.length?te(f):oe()}function Se(){f<w.length&&document.getElementById(w[f].target).classList.remove("tutorial-highlight"),oe()}function oe(){m.remove(),localStorage.setItem("tutorialShown","true"),ee=!1}function Ue(){if(ee){const e=setInterval(()=>{document.getElementById("game-area").style.display==="block"&&(clearInterval(e),setTimeout(()=>{ke(),te(0)},1e3))},100)}}window.tutorialSystem={init:Ue};
