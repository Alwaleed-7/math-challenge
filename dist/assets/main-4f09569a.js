(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const T of i.addedNodes)T.tagName==="LINK"&&T.rel==="modulepreload"&&n(T)}).observe(document,{childList:!0,subtree:!0});function r(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(o){if(o.ep)return;o.ep=!0;const i=r(o);fetch(o.href,i)}})();let s=0,m=0,c=60,I=null,g="easy",l=1,v=JSON.parse(localStorage.getItem("highScores"))||{easy:0,medium:0,hard:0},L=0,h=JSON.parse(localStorage.getItem("achievements"))||{},E=[],A=null,M=0,w=null,S=localStorage.getItem("soundEnabled")!=="false";const ee={"time-boost":30,"point-multiplier":45,"skip-problem":20};let k={"time-boost":0,"point-multiplier":0,"skip-problem":0},P={"time-boost":3,"point-multiplier":2,"skip-problem":3};const $={first_correct:{id:"first_correct",name:"First Steps",description:"Answer your first question correctly",icon:"fa-check",condition:()=>!0,secret:!1,repeatable:!1},speed_demon:{id:"speed_demon",name:"Speed Master",description:"Answer 10 questions correctly in under 20 seconds",icon:"fa-bolt",condition:()=>!1,secret:!1,repeatable:!0},perfect_20:{id:"perfect_20",name:"Perfect Streak",description:"Get a streak of 20 correct answers",icon:"fa-fire",condition:()=>m>=20,secret:!1,repeatable:!0},math_wizard:{id:"math_wizard",name:"Math Wizard",description:"Reach level 10",icon:"fa-hat-wizard",condition:()=>l>=10,secret:!1,repeatable:!1},high_scorer:{id:"high_scorer",name:"High Scorer",description:"Score over 1000 points",icon:"fa-trophy",condition:()=>s>=1e3,secret:!1,repeatable:!0},power_user:{id:"power_user",name:"Power User",description:"Use all power-ups effectively in one game",icon:"fa-bolt",condition:()=>!1,secret:!0,repeatable:!0}};let O={},u=null,U={};const te={correct:"sounds/correct.mp3",wrong:"sounds/wrong.mp3",levelUp:"sounds/level-up.mp3",gameOver:"sounds/game-over.mp3",powerUp:"sounds/power-up.mp3",achievement:"sounds/achievement.mp3"};async function oe(){try{u=new(window.AudioContext||window.webkitAudioContext);for(const[e,t]of Object.entries(te))try{const n=await(await fetch(t)).arrayBuffer(),o=await u.decodeAudioData(n);U[e]=o}catch(r){console.log(`Error loading sound ${e}:`,r)}}catch(e){console.log("Audio context initialization error:",e)}}function b(e){if(!(!S||!u||!U[e]))try{u.state==="suspended"&&u.resume();const t=u.createBufferSource();t.buffer=U[e],t.connect(u.destination),t.start(0)}catch(t){console.log("Sound play error:",t)}}document.addEventListener("click",function e(){u||(oe(),document.removeEventListener("click",e))},{once:!1});const J=document.getElementById("game-menu"),R=document.getElementById("game-area"),q=document.getElementById("game-over"),p=document.getElementById("problem"),B=document.getElementById("answer"),ne=document.getElementById("submit"),re=document.getElementById("score"),D=document.getElementById("timer"),ie=document.getElementById("level"),se=document.getElementById("streak"),le=document.getElementById("streak-progress"),ce=document.getElementById("final-score"),j=document.getElementById("high-score"),ae=document.getElementById("play-again"),ue=document.getElementById("settings-icon"),K=document.getElementById("settings-panel"),me=document.getElementById("close-settings"),_=document.getElementById("sound-toggle"),de=document.getElementById("reset-progress"),N=document.getElementById("achievements-list"),d={"time-boost":document.getElementById("time-boost"),"point-multiplier":document.getElementById("point-multiplier"),"skip-problem":document.getElementById("skip-problem")};Object.keys(d).forEach(e=>{d[e].title=`${e.split("-").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" ")}`,d[e].addEventListener("click",()=>V(e))});const G={easy:{maxNumber:12,operations:["+","-","×"],timeBonus:3,scoreMultiplier:1,initialTime:90},medium:{maxNumber:15,operations:["+","-","×","÷"],timeBonus:2,scoreMultiplier:2,initialTime:60},hard:{maxNumber:20,operations:["+","-","×","÷","^"],timeBonus:1,scoreMultiplier:3,initialTime:45}};document.getElementById("easy").addEventListener("click",()=>z("easy"));document.getElementById("medium").addEventListener("click",()=>z("medium"));document.getElementById("hard").addEventListener("click",()=>z("hard"));function F(e){const t=1+Math.floor((l-1)/3)*.5,r=Math.min(t,2.5),n=Math.max(1,Math.floor(e*(r-1)*.5));return Math.floor(Math.random()*(e*r-n+1))+n}function pe(){const e=G[g];let t;l<=2?t=["+"]:l<=5?t=["+","-"]:l<=7?t=["×"]:l<=10?t=["+","-","×","÷"]:t=["+","-","×","÷","^"];const r=t[Math.floor(Math.random()*t.length)];let n=F(e.maxNumber),o=F(e.maxNumber),i;if(r==="÷")i=n,n=n*o;else switch(r){case"+":i=n+o;break;case"-":i=n-o;break;case"×":i=n*o;break;case"^":o=Math.min(3,o),i=Math.pow(n,o);break}return{problem:`${n} ${r} ${o} = ?`,answer:i}}function z(e){g=e,s=0,m=0,l=1,c=G[e].initialTime,L=v[g],P={"time-boost":3,"point-multiplier":2,"skip-problem":3},O={},E=[],x(),J.style.display="none",R.style.display="block",q.style.display="none",H(),fe(),window.tutorialSystem&&window.tutorialSystem.init()}function x(){re.textContent=s,D.textContent=c,ie.textContent=l,se.textContent=m,le.style.width=`${m/5*100}%`,j.textContent=L}function fe(){I&&clearInterval(I),I=setInterval(()=>{c--,D.textContent=c,c<=0&&Q()},1e3)}function H(){const{problem:e,answer:t}=pe();p.textContent=e,p.dataset.answer=t,B.value="",setTimeout(()=>{B.focus()},10)}function W(){const e=parseInt(B.value),t=parseInt(p.dataset.answer),r=G[g];if(e===t){b("correct"),m++;const n=Math.floor(m/5);let i=(10+Math.floor(l/2))*r.scoreMultiplier*(1+n);A==="point-multiplier"&&(i*=2),s+=i,c+=r.timeBonus,s>l*100&&(l++,b("levelUp")),p.style.color="#48bb78",setTimeout(()=>p.style.color="#2d3748",300),ge("correct"),m>=5&&c>=45&&C("speed_demon")}else{b("wrong"),m=0,c-=5;const n=5*r.scoreMultiplier,o=Math.floor(l/2)*r.scoreMultiplier,i=Math.min(s,n+o);if(s=Math.max(0,s-i),p.style.color="#e53e3e",setTimeout(()=>p.style.color="#2d3748",300),c<=0){Q();return}}x(),H()}function Q(){clearInterval(I),s>v[g]&&(v[g]=s,L=s,localStorage.setItem("highScores",JSON.stringify(v))),R.style.display="none",q.style.display="block",ce.textContent=s,j.textContent=v[g],he()}ne.addEventListener("click",W);B.addEventListener("keypress",e=>{e.key==="Enter"&&W()});ae.addEventListener("click",()=>{q.style.display="none",J.style.display="block"});ue.addEventListener("click",()=>{K.classList.add("active")});me.addEventListener("click",()=>{K.classList.remove("active")});_.addEventListener("change",()=>{S=_.checked,localStorage.setItem("soundEnabled",S)});de.addEventListener("click",()=>{confirm("Are you sure you want to reset all progress? This will clear your high scores and achievements.")&&(localStorage.removeItem("highScores"),localStorage.removeItem("achievements"),v={easy:0,medium:0,hard:0},L=0,h={},j.textContent="0",alert("Progress has been reset!"))});_.checked=S;function ge(e){e==="correct"&&!h.first_correct&&C("first_correct"),Object.values($).forEach(t=>{!h[t.id]&&t.condition()&&C(t.id)})}function C(e){if(h[e])return;const t=$[e];h[e]=!0,localStorage.setItem("achievements",JSON.stringify(h)),E.includes(e)||E.push(e),b("achievement");const r=50;s+=r,x();const n=document.createElement("div");n.className="achievement-notification",n.innerHTML=`
        <i class="fas ${t.icon}"></i>
        <div>
            <h4>${t.name}</h4>
            <p>${t.description}</p>
            <span class="achievement-bonus">+${r} points!</span>
        </div>
    `,document.body.appendChild(n),setTimeout(()=>{n.classList.add("fade-out"),setTimeout(()=>n.remove(),500)},3e3)}function he(){if(N.innerHTML="",E.length===0){const e=document.createElement("div");e.className="no-achievements",e.textContent="No achievements earned this game.",N.appendChild(e);return}E.forEach(e=>{const t=$[e];if(t){const r=document.createElement("div");r.className="achievement-badge unlocked",r.innerHTML=`
                <i class="fas ${t.icon}"></i>
                <span>${t.name}</span>
            `,r.title=t.description,N.appendChild(r)}})}Object.keys(d).forEach(e=>{d[e].addEventListener("click",()=>V(e))});function V(e){if(k[e]>0||P[e]<=0)return;switch(P[e]--,updatePowerUpCounts(),O[e]=!0,Object.keys(O).length===Object.keys(d).length&&!h.power_user&&C("power_user"),b("powerUp"),e){case"time-boost":c+=15;break;case"point-multiplier":A=e,M=15,w&&clearInterval(w),w=setInterval(()=>{M--,M<=0&&(clearInterval(w),A=null)},1e3);break;case"skip-problem":H();break}k[e]=ee[e],d[e].classList.add("cooldown");const t=setInterval(()=>{k[e]--,k[e]<=0&&(clearInterval(t),d[e].classList.remove("cooldown"))},1e3);x()}let X=localStorage.getItem("tutorialShown")!=="true",a,f=0,y=[{target:"time-boost",title:"Time Boost",description:"Adds 15 seconds to your timer. Use this when you need more time!",position:"bottom"},{target:"point-multiplier",title:"Point Multiplier",description:"Doubles all points earned for 15 seconds. Great for boosting your score!",position:"bottom"},{target:"skip-problem",title:"Skip Problem",description:"Skip the current problem without penalty. Perfect for difficult questions!",position:"bottom"}];function ye(){a=document.createElement("div"),a.className="tutorial-overlay",document.body.appendChild(a);const e=document.createElement("div");e.className="tutorial-content",a.appendChild(e);const t=document.createElement("h3");t.className="tutorial-title",e.appendChild(t);const r=document.createElement("p");r.className="tutorial-description",e.appendChild(r);const n=document.createElement("div");n.className="tutorial-nav",e.appendChild(n);const o=document.createElement("button");o.className="tutorial-btn",o.textContent="Next",o.addEventListener("click",ve),n.appendChild(o);const i=document.createElement("button");i.className="tutorial-btn tutorial-skip",i.textContent="Skip Tutorial",i.addEventListener("click",be),n.appendChild(i)}function Y(e){const t=y[e],r=document.getElementById(t.target),n=r.getBoundingClientRect(),o=a.querySelector(".tutorial-content");a.querySelector(".tutorial-title").textContent=t.title,a.querySelector(".tutorial-description").textContent=t.description,t.position==="bottom"?(o.style.top=`${n.bottom+10}px`,o.style.left=`${n.left+n.width/2-150}px`):t.position==="top"&&(o.style.top=`${n.top-o.offsetHeight-10}px`,o.style.left=`${n.left+n.width/2-150}px`),r.classList.add("tutorial-highlight"),e===y.length-1&&(a.querySelector(".tutorial-btn").textContent="Got it!")}function ve(){f<y.length&&document.getElementById(y[f].target).classList.remove("tutorial-highlight"),f++,f<y.length?Y(f):Z()}function be(){f<y.length&&document.getElementById(y[f].target).classList.remove("tutorial-highlight"),Z()}function Z(){a.remove(),localStorage.setItem("tutorialShown","true"),X=!1}function Ee(){if(X){const e=setInterval(()=>{document.getElementById("game-area").style.display==="block"&&(clearInterval(e),setTimeout(()=>{ye(),Y(0)},1e3))},100)}}window.tutorialSystem={init:Ee};
